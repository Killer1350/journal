 <!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trading Journal</title>
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --muted:#9aa4b2;
      --accent:#22c55e;
      --danger:#ef4444;
      --glass:rgba(255,255,255,.04)
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial;
      background:linear-gradient(180deg,#071026,#071827);
      color:#e6eef6; min-height:100vh; padding:24px
    }
    .container{max-width:1100px;margin:auto}
    h1{margin:0;font-size:20px}
    .sub{font-size:13px;color:var(--muted)}

    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}

    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px}
    .card{
      background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));
      border:1px solid rgba(255,255,255,.05);
      border-radius:14px; padding:16px
    }

    label{font-size:12px;color:var(--muted)}
    input,select,textarea{
      width:100%; margin-top:4px; padding:8px;
      background:transparent; color:inherit;
      border-radius:8px; border:1px solid rgba(255,255,255,.08)
    }
    textarea{resize:vertical;min-height:60px}

    .row{display:flex;gap:8px;margin-bottom:10px}

    button{
      padding:10px 12px; border-radius:10px;
      border:none; cursor:pointer; font-weight:600
    }
    .primary{background:var(--accent);color:#02220f}
    .ghost{background:transparent;border:1px solid rgba(255,255,255,.12);color:var(--muted)}
    .danger{background:var(--danger);color:white}

    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,.06);font-size:13px}
    th{font-size:12px;color:var(--muted)}

    .pnl-pos{color:#7ef4a1;font-weight:700}
    .pnl-neg{color:#ff9b9b;font-weight:700}

    .stats{display:flex;gap:8px;flex-wrap:wrap}
    .stat{flex:1 1 120px;background:var(--glass);border-radius:10px;padding:12px;text-align:center}
    .stat b{font-size:18px}
    .stat span{font-size:12px;color:var(--muted)}

    @media(max-width:900px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
<div class="container">

<header>
  <div>
    <h1>Trading Journal</h1>
    <div class="sub">Local browser journal • no backend • works everywhere</div>
  </div>
  <div class="sub">Saved per browser</div>
</header>

<div class="grid">

<!-- Trades -->
<div class="card">
  <b>Trades</b>
  <table>
    <thead>
      <tr>
        <th>Date</th><th>Symbol</th><th>Dir</th><th>Entry</th><th>Exit</th><th>PnL</th><th></th>
      </tr>
    </thead>
    <tbody id="rows"></tbody>
  </table>
  <button class="danger" id="clearAll" style="margin-top:10px">Clear All</button>
</div>

<!-- Form -->
<div class="card">
  <b>Add Trade</b>
  <form id="form">
    <input type="hidden" id="id">

    <div class="row">
      <div><label>Date</label><input type="date" id="date" required></div>
      <div><label>Symbol</label><input id="symbol" required></div>
    </div>

   <div class="row">
  <div>
    <label>Instrument</label>
    <select id="instrument">
      <option value="forex">Forex</option>
      <option value="gold">Gold (XAUUSD)</option>
      <option value="indices">Indices</option>
      <option value="crypto">Crypto</option>
      <option value="custom">Custom</option>
    </select>
  </div>

  <div>
    <label>Direction</label>
    <select id="dir">
      <option>Long</option>
      <option>Short</option>
    </select>
  </div>

  <div>
    <label>Lot / Size</label>
    <input type="number" id="size" step="any" placeholder="0.10">
  </div>
</div>

<div class="row" id="customWrap" style="display:none">
  <div>
    <label>Contract Size</label>
    <input type="number" id="contract" step="any" placeholder="e.g. 100000">
  </div>
</div>


    <div class="row">
      <div><label>Entry</label><input type="number" id="entry" step="any" required></div>
      <div><label>Exit</label><input type="number" id="exit" step="any" required></div>
    </div>

    <label>Notes</label>
    <textarea id="notes"></textarea>

    <div style="display:flex;gap:8px;margin-top:10px">
      <button class="primary">Save</button>
      <button type="button" class="ghost" id="reset">Reset</button>
    </div>
  </form>

  <hr style="border:none;border-top:1px solid rgba(255,255,255,.06);margin:14px 0">

  <b>Summary</b>
  <div class="stats">
    <div class="stat"><b id="total">0</b><br><span>Total PnL</span></div>
    <div class="stat"><b id="win">0%</b><br><span>Win rate</span></div>
    <div class="stat"><b id="count">0</b><br><span>Trades</span></div>
  </div>
</div>

</div>
</div>

<script>
const KEY = 'journal_v2';
let trades = JSON.parse(localStorage.getItem(KEY) || '[]');

const $ = id => document.getElementById(id);

function uid(){return 't'+Math.random().toString(36).slice(2,8)}
function pnl(t){
  const diff = t.dir === 'Long'
    ? (t.exit - t.entry)
    : (t.entry - t.exit);

  let contract = 1;

  switch (t.instrument) {
    case 'forex':
      contract = 100000;
      break;
    case 'gold':
      contract = 100;
      break;
    case 'indices':
      contract = 1;
      break;
    case 'crypto':
      contract = 1;
      break;
    case 'custom':
      contract = Number(t.contract) || 1;
      break;
  }

  const size = Number(t.size) || 1;
  return Number((diff * size * contract).toFixed(2));
}

function save(){localStorage.setItem(KEY, JSON.stringify(trades))}

function render(){
  const body = $('rows'); body.innerHTML='';
  trades.sort((a,b)=>b.date.localeCompare(a.date)).forEach(t=>{
    body.innerHTML += `<tr>
      <td>${t.date}</td>
      <td>${t.symbol}</td>
      <td>${t.dir}</td>
      <td>${t.entry}</td>
      <td>${t.exit}</td>
      <td class="${t.pnl>=0?'pnl-pos':'pnl-neg'}">${t.pnl>=0?'+':''}${t.pnl}</td>
      <td><button class="ghost" onclick="edit('${t.id}')">Edit</button></td>
    </tr>`
  });

  const total = trades.reduce((s,t)=>s+t.pnl,0);
  const wins = trades.filter(t=>t.pnl>0).length;
  $('total').textContent = total.toFixed(2);
  $('count').textContent = trades.length;
  $('win').textContent = trades.length?Math.round(wins/trades.length*100)+'%':'0%';
}

form.onsubmit = e =>{
  e.preventDefault();

  const t = {
    id: id.value || uid(),
    date: date.value,
    symbol: symbol.value.toUpperCase(),
    instrument: instrument.value,
    dir: dir.value,
    entry: +entry.value,
    exit: +exit.value,
    size: +size.value || 1,
    contract: +contract.value || null,
    notes: notes.value
  };

  t.pnl = pnl(t);

  const i = trades.findIndex(x=>x.id===t.id);
  i>-1 ? trades[i]=t : trades.push(t);

  save(); resetForm(); render();
};

function edit(i){
  const t = trades.find(x=>x.id===i);
  if(!t) return;
  Object.assign(window,{id:{value:t.id}});
  date.value=t.date; symbol.value=t.symbol; dir.value=t.dir;
  entry.value=t.entry; exit.value=t.exit; size.value=t.size; notes.value=t.notes;
}

function resetForm(){form.reset(); id.value=''}
reset.onclick=resetForm;

clearAll.onclick=()=>{ if(confirm('Clear all trades?')){trades=[];save();render()} }
instrument.onchange = () => {
  customWrap.style.display =
    instrument.value === 'custom' ? 'flex' : 'none';
};

render();
</script>
</body>
</html>
